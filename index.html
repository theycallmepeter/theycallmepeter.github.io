<!DOCTYPE html>
<html lang="en">

	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" href="data:,">
		<title>Map of the Internet</title>
		<meta charset="utf-8">
		<!-- <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"> -->
		<link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/pure-min.css" integrity="sha384-LTIDeidl25h2dPxrB2Ekgc9c7sEC3CWGM6HeFmuDNUjX76Ert4Z4IY714dhZHPLd" crossorigin="anonymous">
		<link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/grids-responsive-min.css">

		<link rel="stylesheet" href="style.css">
		<script type="text/javascript" src="./build/dat.gui.min.js"></script>

	</head>

	<body>

		<div class="header">
		    <div class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
		        <a class="pure-menu-heading" href="">Peter's corner</a>

		        <ul class="pure-menu-list">
		            <li class="pure-menu-item pure-menu-selected"><a href="#" class="pure-menu-link">About me</a></li>
		            <li class="pure-menu-item"><a href="#" class="pure-menu-link">Contact me</a></li>
		        </ul> 
		    </div>
		</div>

		<div class="splash-container" id="container">
		    <div class="splash" id="introduction">
		        <h1 class="splash-head">Map of the Internet</h1>
		        <p class="splash-subhead">
		            You can find the controls to the visualisation in the top right corner. Hover over the about section and scroll down to see an overview of what is represented on the map. 
		        </p>
		        <p>
		            <a onclick="removeintro()" class="pure-button pure-button-primary">Get Started</a>
		        </p>
		    </div>
		</div>

		<div class="content-wrapper">
		    <div class="content brightribbon">
		        <h2 class="content-head is-center">vvv Map information vvv</h2>

		        <div class="pure-g">
		            <div class="l-box pure-u-1 pure-u-md-1-2 pure-u-lg-1-4">

		                <h3 class="content-subhead">
		                    <i class="fa fa-rocket"></i>
		                    Get Started Quickly
		                </h3>
		                <p>
		                    Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.
		                </p>
		            </div>
		            <div class="l-box pure-u-1 pure-u-md-1-2 pure-u-lg-1-4">
		                <h3 class="content-subhead">
		                    <i class="fa fa-mobile"></i>
		                    Responsive Layouts
		                </h3>
		                <p>
		                    Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.
		                </p>
		            </div>
		            <div class="l-box pure-u-1 pure-u-md-1-2 pure-u-lg-1-4">
		                <h3 class="content-subhead">
		                    <i class="fa fa-th-large"></i>
		                    Modular
		                </h3>
		                <p>
		                    Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.
		                </p>
		            </div>
		            <div class="l-box pure-u-1 pure-u-md-1-2 pure-u-lg-1-4">
		                <h3 class="content-subhead">
		                    <i class="fa fa-check-square-o"></i>
		                    Plays Nice
		                </h3>
		                <p>
		                    Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.
		                </p>
		            </div>
		        </div>
		    </div>

		    <div class="ribbon l-box-lrg pure-g">
		        <!-- <div class="l-box-lrg is-center pure-u-1 pure-u-md-1-2 pure-u-lg-2-5">
		            <img width="300" alt="File Icons" class="pure-img-responsive" src="/img/common/file-icons.png">
		        </div> -->
		        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-3-5">

		            <h2 class="content-head content-head-ribbon">Laboris nisi ut aliquip.</h2>

		            <p>
		                Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
		                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
		                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
		                consequat. Duis aute irure dolor.
		            </p>
		        </div>
		    </div>
		</div>


		<script type="module">
			import * as THREE from 'https://unpkg.com/three@0.125.2/build/three.module.js';
			import { OrbitControls } from 'https://unpkg.com/three@0.125.2/examples/jsm/controls/OrbitControls.js';
			import { Stats } from "/libs/stats.min.js";
			var container, stats;
			var camera, scene, renderer;
			var group;

			var windowHalfX = window.innerWidth / 2;
			var windowHalfY = window.innerHeight / 2;

			init();
			animate();

			function init() {

				container = document.getElementById( 'container' );

				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight / 0.87, 1, 2000 );
				camera.position.z = 500;

				scene = new THREE.Scene();

				group = new THREE.Object3D();
				scene.add( group );

				// earth

				var loader = new THREE.TextureLoader();
				var mesh;
				loader.load( 'textures/2020_12_08/ipv4_platecarree.jpg', function ( texture ) {

					texture.needsUpdate = true;
					var geometry = new THREE.SphereGeometry( 200, 64, 64 );
					var material = new THREE.MeshBasicMaterial( { map: texture } );
					mesh = new THREE.Mesh( geometry, material );
					group.add( mesh );

				} );


				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setClearColor( 0x333333 );
				renderer.setSize( window.innerWidth, window.innerHeight * 0.87);
				// renderer.domElement.classList.add('splash');
				container.appendChild( renderer.domElement );

				// controls
				const controls = new OrbitControls( camera, renderer.domElement);
				controls.minDistance = 225;
				controls.maxDistance = 500;
				controls.enablePan = false;



				// Performance overlay
				stats = new Stats();
				stats.domElement.style.position = 'absolute';
				stats.domElement.style.top = '0px';
				container.appendChild( stats.domElement );

				const params = {
					date: '2020_12_08/',
					ipv4: true,
					ipv6: false,
					edges: true,
				};

				//GUI
				const gui = new dat.GUI({autoPlace: false});
				gui.add(params, 'date', { "Dec 2020": '2020_12_08/', "July 2017": '2017_06_06/'} ).name('Date').onChange( changeTexture );
				gui.add(params, 'ipv4').name('IPv4').listen().onChange(function(){changeIPVersion("ipv4")});
				gui.add(params, 'ipv6').name('IPv6').listen().onChange(function(){changeIPVersion("ipv6")});
				gui.add(params, 'edges').name('Edges').onChange( changeTexture );
				gui.domElement.style.position = 'absolute';
				gui.domElement.style.top = '0px';
				gui.domElement.style.right = '0px'
				gui.domElement.style.float = 'right';
				container.appendChild(gui.domElement);

				function changeIPVersion(ver){
					params.ipv4 = false
					params.ipv6 = false
					params[ver] = true
					changeTexture()
				}

				function changeTexture(){
					var ver;
					var filename;
					if (params.ipv6) ver = "ipv6_";
					if (params.ipv4) ver = "ipv4_";
					if (params.edges) {
						filename = "platecarree.jpg";
					} else {
						filename = "platecarree_centroid.png";
					}
					loader.load( ['./textures/', params.date, ver, filename].join('') , function ( texture ) {
						mesh.material.map = texture;
    					mesh.material.needsUpdate = true;
						// texture.needsUpdate = true;
						// var geometry = new THREE.SphereGeometry( 200, 64, 64 );
						// var material = new THREE.MeshBasicMaterial( { map: texture } );
						// var mesh = new THREE.Mesh( geometry, material );
						// group.add( mesh );

					},
					xhr => {
					    //Download Progress
					    console.log((xhr.loaded / xhr.total) * 100 + "% loaded");
					} );
				}

				//

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function onWindowResize() {

				windowHalfX = window.innerWidth / 2;
				windowHalfY = window.innerHeight / 2;

				camera.aspect = window.innerWidth / window.innerHeight / 0.87;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight * 0.87);

			}


			function animate() {

				requestAnimationFrame( animate );

				render()

				stats.update();

			}

			function render() {

				renderer.render( scene, camera );

			}


		</script>

		<script type="text/javascript">
			function removeintro(){
				var obj = document.getElementById("introduction");
				obj.remove();
			}
		</script>

	</body>
</html>
